[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Project Milestone",
  "enabled": 1,
  "modified": "2024-02-21 14:04:44.526688",
  "module": null,
  "name": "project Milestone",
  "script": "frappe.ui.form.on('Project Milestone', {\n\trefresh(frm) {\n\t    frm.add_custom_button(__('Go To Project'), function(){\n            window.open(`/app/project/${frm.doc.parent_project}`)\n        });\n        \n    \t frm.add_custom_button(__('Go To Task'), function(){\n            window.open(`/app/task?custom_parent_milestone=${frm.doc.name}`)\n        });\n        \n        frm.add_custom_button(__('Go To Story'), function(){\n           window.open(`/app/story?parent_milestone=${frm.doc.name}`)\n        });\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Story",
  "enabled": 1,
  "modified": "2024-02-21 14:05:16.745203",
  "module": null,
  "name": "Story",
  "script": "frappe.ui.form.on('Story', {\n\trefresh(frm) {\n\t\tfrm.add_custom_button(__('Go To Project'), function(){\n            window.open(`/app/project/${frm.doc.parent_project}`)\n        });\n        frm.add_custom_button(__('Go To Milestone'), function(){\n            window.open(`/app/project-milestone/${frm.doc.parent_milestone}`)\n        });\n        frm.add_custom_button(__('Go To Task'), function(){\n            window.open(`/app/task/view/list?custom_parent_story=${frm.doc.name}`)\n        });\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Task",
  "enabled": 1,
  "modified": "2024-02-21 14:05:02.448313",
  "module": null,
  "name": "Task",
  "script": "frappe.ui.form.on('Task', {\n\trefresh(frm) {\n\t\tfrm.add_custom_button(__('Go To Project'), function(){\n            window.open(`/app/project/${frm.doc.project}`)\n        });\n        frm.add_custom_button(__('Go To Milestone'), function(){\n            window.open(`/app/project-milestone/${frm.doc.custom_parent_milestone}`)\n        });\n        frm.add_custom_button(__('Go To Story'), function(){\n            window.open(`/app/story/${frm.doc.custom_parent_story}`)\n        });\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Timesheet",
  "enabled": 1,
  "modified": "2024-03-14 20:32:45.589148",
  "module": "Ctrine",
  "name": "Populating Rows",
  "script": "frappe.ui.form.on('Timesheet', {\n    onload: function(frm) {\n        // Check if the document is not saved or submitted\n        if (frm.doc.__unsaved || frm.doc.docstatus === 0) {\n            var creation_datetime;\n\n            // Fetch current date and time when creating a new timesheet\n            creation_datetime = frappe.datetime.now_datetime();\n\n            // Assign date and time for the first row if it exists\n            if (frm.doc.time_logs && frm.doc.time_logs.length > 0) {\n                frm.doc.time_logs[0].from_time = creation_datetime;\n                // Other field assignments can be done similarly\n            }\n\n            // Auto-populate rows based on the day of the week\n            var dayOfWeek = new Date(creation_datetime).getDay();\n            var numRowsToAdd = 0;\n\n            switch(dayOfWeek) {\n                case 1: // Monday\n                    numRowsToAdd = 5;\n                    break;\n                case 2: // Tuesday\n                    numRowsToAdd = 4;\n                    break;\n                case 3: // Wednesday\n                    numRowsToAdd = 3;\n                    break;\n                case 4: // Thursday\n                    numRowsToAdd = 2;\n                    break;\n                case 5: // Friday\n                    numRowsToAdd = 1;\n                    break;\n                    \n                default:\n                    numRowsToAdd = 0; // Add no rows for other days\n            }\n\n            // Populate rows in the child table starting from the second row\n            var start_datetime = frappe.datetime.add_days(creation_datetime, 1); // Start from the next day\n            for (var i = 1; i < numRowsToAdd; i++) { // Start from i=1 for the second row\n                var new_row = frappe.model.add_child(frm.doc, \"Timesheet Detail\", \"time_logs\");\n                new_row.from_time = start_datetime;\n                // Other field assignments can be done similarly\n                start_datetime = frappe.datetime.add_days(start_datetime, 1); // Move to the next day\n            }\n\n            // Refresh the child table to reflect the changes\n            frm.refresh_field('time_logs');\n        }\n    }\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Timesheet",
  "enabled": 0,
  "modified": "2024-03-14 19:59:09.205850",
  "module": "Ctrine",
  "name": "Reason",
  "script": "frappe.ui.form.on('Timesheet', {\n    refresh: function(frm) {\n        if (cur_frm.doc.workflow_state === 'Approval') {\n            // Define a function to show the dialog\n            var showDialog = function() {\n                let d = new frappe.ui.Dialog({\n                    title: 'Reason',\n                    fields: [{\n                        label: 'Reason',\n                        fieldname: 'reason',\n                        fieldtype: 'Small Text'\n                    }],\n                    size: 'large',\n                    primary_action_label: __('Submit'),\n                    primary_action: function() {\n                        frappe.call({\n                            method: 'ctrine.ctrine.server_scripts.timesheet.approve_reason',\n                            args: {\n                                docname: frm.docname,\n                                reason: d.get_value('reason'),\n                            },\n                            callback: function(response) {\n                                console.log(response.message);\n                                frm.reload_doc();\n                                d.hide();\n                            }\n                        });\n                    }\n                });\n                d.show();\n            };\n\n            // Invoke the function to show the dialog\n            showDialog();\n        }\n    }\n});\n\n\n------------CS----------------------",
  "view": "Form"
 }
]